<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="do.sibsutis.ru">

  <title>Лекция 5. Конспект лекций</title>
	
	<link rel="icon" type="image/png" href="../lib/css/favicon.png">
  <!-- Bootstrap Core CSS -->
  <link href="../lib/css/bootstrap.css" rel="stylesheet">
	
  <!-- Custom CSS -->
  <link href="../lib/css/scrolling-nav.css" rel="stylesheet">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>

<!-- The #page-top ID is part of the scrolling feature - the data-spy and data-target are part of the built-in Bootstrap scrollspy function -->

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">
  <!-- Navigation -->
<nav class="navbar navbar-default navbar-fixed-top">
 <div class="container">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
   <li class="hidden"> <a class="page-scroll" href="#page-top"></a> </li>
	 
	 <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
   </button>
	 
   <a class="navbar-brand " href="../index.htm"> 
  <text class = "hidden-xs">Защита информации</text> 
  <text class = "visible-xs">ЗИ</text>
	 </a>
  </div>

  <!-- Collect the nav links, forms, and glyphicon glyphicon-list-alt content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
   
	 <!-- <ul class="nav navbar-nav">
		<li><a href="#"></a></li> 
   </ul> -->
	
   <ul class="nav navbar-nav navbar-right">
    <li class="dropdown">
		<button type="button" class="navbar-toggle dropdown-toggle hidden-xs" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		</button>	   
		<a class = "dropdown-toggle visible-xs" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Материалы</a>
     <ul class="dropdown-menu">
    <li><a href="../index.htm">Аннотация курса</a></li>
      <li role="separator" class="divider"></li>
  
 <li><a href="lec_index.htm">Теория</a></li>
   
 <li><a href="c_work.htm">Контрольная работа</a></li>
 
<li><a href="labs.htm">Лабораторные работы</a></li> 
      <li role="separator" class="divider"></li>
    
      <li><a href="lit.htm">Литература</a></li>
      <!--li><a href="q.htm">Вопросы для самопроверки</a></li-->			
     </ul>
 </li>
 </ul>
  </div><!-- /.navbar-collapse -->
 </div><!-- /.container-fluid -->
</nav>


  <div id="intro" class="section content-section ">
    <div class="container">
       <div class="row">
        <div class="col-lg-12">	


<!-- содержание -->	
<div class="page-header">				
<h3>5. Электронная или цифровая подпись</h3>

<a href="lec5.htm#1" class=punkt>5.1. Электронная подпись RSA</a><br>
<a href="lec5.htm#2" class=punkt>5.2. Стандарты на электронную (цифровую) подпись</a><br>
<a href="lec5.htm#3" class=punkt>Задачи и упражнения</a><br>

</div>
<!--начало-->
<a name=1 class="anchor"></a>
<h3>5.1. Электронная подпись RSA</h3>
<p>После появления криптографии с открытым ключом произошла настоящая революция в современных компьютерных и сетевых технологиях. Появилась возможность решать задачи, которые ранее считались неразрешимыми, а теперь находят широкое применение на практике. В настоящее время при помощи этих технологий ежедневно проводятся расчеты и совершаются сделки на многие миллиарды долларов, рублей, евро и т.п. Одним из важны элементов этих технологий является электронная, или цифровая подпись. Во многих странах и, в частности, в России введены стандарты на электронную (цифровую) подпись, а само это понятие введено в гражданское законодательство. Термин «электронная подпись» более привычен для России, хотя в последнее время все чаще используется принятый в других странах (прежде всего, в США) термин «цифровая подпись», что отражено и в новых российских стандартах. Оба термина означают одно и то же. </p>
<p>Прежде чем начать рассмотрение криптографической цифровой подписи, сформулируем три свойства, которым (в идеале) должна удовлетворять любая, в частности, обычная рукописная подпись: </p>
<p class=punkt>1. Подписать документ может только «законный» владелец подписи (и, следовательно, никто не может подделать подпись). </p>
<p class=punkt>2. Автор подписи не может от нее отказаться.</p>
<p class=punkt>3. В случае возникновения спора возможно участие третьих лиц (например, суда) для установления подлинности подписи. </p>
<p>Разумеется, цифровая (электронная) подпись также должна обладать всеми этими свойствами, однако лица, подписывающие документы и проверяющие их подлинность, могут находиться за тысячи километров друг от друга и взаимодействовать только через компьютерную сеть.</p>
<p>Кроме обычной подписи, в реальной жизни используется так называемая нотариальная подпись, когда специально выделяемое лицо (нотариус) заверяет документы своей подписью и печатью, так что любое другое лицо может удостовериться в их подлинности. Аналог этой подписи также востребован в киберпространстве. Электронная нотариальная подпись реализуется точно так же, как и подпись любого другого лица. </p>
<p>В этом разделе мы рассмотрим электронную подпись, базирующуюся на схеме RSA. </p>
<p>Если Алиса планирует подписывать документы, то она должна вначале выбрать параметры RSA точно так же, как это описано в разд. 2.б. Для этого Алиса выбирает два больших просты числа <i>Р</i> и <i>Q</i>, вычисляет <img src="img/image503.png" height="22" width="244">. Затем она выбирает число <i>d</i>, взаимно простое с <img src="img/image504.png" height="19" width="13">, и вычисляет <img src="img/image505.png" height="24" width="123">. Наконец, она публикует числа <i>N</i> и <i>d</i>, например, помещает их на своем сайте, ассоциировав со своим именем, и хранит в секрете число <i>с</i> (остальные числа <i>Р</i>, <i>Q</i> и <img src="img/image504.png" height="19" width="13"> можно забыть, они больше не потребуются). Теперь Алиса готова ставить свои подписи на документах или сообщениях. </p>
<p>Пусть Алиса хочет подписать сообщение <img src="img/image410.png" height="17" width="18">=<i>m<sub>1</sub>, ... , m<sub>n</sub></i>. Тогда вначале она вычисляет криптографическую хеш-функцию </p>
<p><img src="img/image506.png" height="29" width="176"></p>
<p>которая ставит в соответствие сообщению <img src="img/image410.png" height="17" width="18"> число <i>у</i>. Предполагается, что алгоритм вычисления хеш-функции всем известен. Отметим наиболее важное для нас свойство используемой хеш-функции: практически невозможно изменить основной текст <i>m<sub>1</sub>, ... , m<sub>n</sub></i>, не изменив <i>y</i>. Поэтому на следующем шаге Алисе достаточно снабдить подписью только число <i>y</i>, и эта подпись будет относиться ко всему сообщению <img src="img/image410.png" height="17" width="18">.</p>
<p> Алиса вычисляет число </p>
<p><img src="img/image507.png" height="25" width="133">              (5.1)</p>
<p>т.е. она возводит число <i>y</i> в свою секретную степень. Число <i>s</i> это и есть цифровая подпись. Она просто добавляется к сообщению <img src="img/image410.png" height="17" width="18">, и тем самым Алиса имеет сформированное подписанное сообщение </p>
<p><img src="img/image508.png" height="29" width="80">              (5.2)</p>
<p>Теперь каждый, кто знает открытые параметры Алисы, ассоциированные с ее именем, т.е. числа <i>N</i> и <i>d</i>, может проверить подлинность ее подписи. Для этого необходимо, взяв подписанное сообщение (5.2), вычислить значение хеш-функции <img src="img/image509.png" height="22" width="46">, число </p>
<p><img src="img/image510.png" height="28" width="131">              (5.3)</p>
<p>и проверить выполнение равенства <img src="img/image497.png" height="13" width="17"> = <img src="img/image509.png" height="22" width="46">.</p>
<p><b>Утверждение 5.1.</b> <i>Если подпись подлинная, то </i><img src="img/image497.png" height="13" width="17"> = <img src="img/image509.png" height="22" width="46">.</p>
<p>Д о к а з а т е л ь с т в о. Из (5.3), (5.1) и свойств схемы RSA (см. разд. 2.б) следует </p>
<p><img src="img/image511.png" height="31" width="344"></p>
<p><b>Утверждение 5.2.</b> <i>Описанная электронная подпись удовлетворяет всем требованиям, предъявляемым к подписи</i>.</p>
<p>Д о к а з а т е л ь с т в о. Проверим первое свойство подписи. Никто не может разложить число <i>N</i> на простые множители (при боль-ших N порядка 1024 бит по состоянию на 2005 год эта задача прак-тически неразрешима). Поэтому, зная N и д невозможно найти <i>с</i>. Действительно, чтобы вычислить <img src="img/image505.png" height="24" width="123">, нужно знать <img src="img/image512.png" height="22" width="155">, а для этого нужно знать простые множители <i>Р</i> и <i>Q</i>. Таким образом, первое свойство выполнено никто, кроме Алисы, не может знать число <i>с</i> и поэтому не может подписать сообщение. </p>
<p>Второе свойство выполнено вследствие первого. Автор подписи не может от нее отказаться, так как никто другой не может «сфабриковать» подпись от его имени. </p>
<p>Третье свойство также очевидно в случае спора заинтересованная сторона может предъявить судье все вычисления для их проверки и выяснения истины. </p>
<p>П р и м е р 5.1. Пусть <i>Р = 5, Q = 11</i>. Тогда <i>N = 5 <span style='font-size:8.0pt;line-height:150%'>•</span> 11 = 55, <img src="img/image504.png" height="19" width="13"> = 4 <span style='font-size:8.0pt;line-height:150%'>•</span> 10 = 40</i>. Пусть <i>d = 3</i>. Такой выбор <i>d</i> возможен, так как <img src="img/image513.png" height="22" width="32"><i>(40, 3)= 1</i>. Параметр <img src="img/image514.png" height="23" width="134"> вычисляем с помощью обобщенного алгоритма Евклида (см. разд. 2.3), <i>с = 27</i>. </p>
<p>Пусть, например, Алиса хочет подписать сообщение <img src="img/image515.png" height="16" width="97">, для которого значение хеш-функции равно, скажем, 13:</p>
<p><img src="img/image516.png" height="24" width="186"></p>
<p> В этом случае Алиса вычисляет по (5.1) </p>
<p><img src="img/image517.png" height="29" width="190"></p>
<p>и формирует подписанное сообщение </p>
<p><img src="img/image518.png" height="26" width="120"></p>
<p>Теперь тот, кто знает открытые ключи Алисы <i>N = 55</i> и <i>d = 3</i>, может проверить подлинность подписи. Получив подписанное сообщение, он заново вычисляет значение хеш-функции </p>
<p><img src="img/image519.png" height="27" width="149"></p>
<p>(если содержание сообщения не изменено, то значение хеш-функции совпадет с тем, которое вычисляла Алиса) и вычисляет по (5.3) </p>
<p><img src="img/image520.png" height="27" width="189"></p>
<p>Значения <img src="img/image504.png" height="19" width="13"> и хеш-функции совпали, значит, подпись верна. </p>
<p>З а м е ч а н и е. Обратим внимание на то, что одна и та же схема RSA, сгенерированная Алисой, может использоваться для решения двух задач. Во-первых, Алиса может подписывать сообщения, как это было показано в данном разделе, используя свой секретный ключ <i>с</i>. Во-вторых, кто угодно может послать Алисе зашифрованное сообщение (число), расшифровать которое, как это было показано в разд. 2.6, сможет только она, используя для шифрования ее открытый ключ <i>d</i>. </p>
<br>
<a name=2 class="anchor"></a>
<h3>5.2. Стандарты на электронную (цифровую) подпись</h3>
<p>Во многих странах сегодня существуют стандарты на электронную (цифровую) подпись. В этом разделе мы опишем российский государственный стандарт ГОСТ Р34.10-94 и стандарт США FIPS 186. Российский стандарт, как следует из его обозначения, был принят в 1994 году, американский в 1991. В основе обоих стандартов лежит по сути один и тот же алгоритм, называемый DSA (Digital Signature Algorithm). Мы подробно рассмотрим российскую версию алгоритма, а затем укажем на отличия американской версии.</p>
<p>Вначале для некоторого сообщества пользователей выбираются общие несекретные параметры. Прежде всего необходимо найти два простых числа, <i>q</i> длиной 256 бит и <i>р</i> длиной 1024 бита, между которыми выполняется соотношение </p>
<p><img src="img/image521.png" height="22" width="114">              (5.4)</p>
<p>для некоторого целого <i>Ь</i>. Старшие биты в <i>р</i> и <i>q</i> должны быть равны единице. Затем выбирается число <i>а > 1</i>, такое, что </p>
<p><img src="img/image522.png" height="28" width="144">              (5.5)</p>
<p>В результате получаем три общих параметра <i>р</i>, <i>q</i> и <i>а</i>.</p>
<p>З а м е ч а н и е. Равенство (5.5) означает, что при возведении <i>а</i> в степени по модулю <i>р</i> показатели приводятся по модулю <i>q</i>, т.е. <img src="img/image523.png" height="22" width="72">=<img src="img/image524.png" height="23" width="114"> (мы уже проводили обоснование подобного феномена при доказательстве утверждения 2.10 на стр. 35). Такое приведение будет постоянно выполняться при генерации и проверке подписи, в результате чего длина показателей степени в рамках рассматриваемого алгоритма никогда не будет превышать 256 бит, что упрощает вычисления. </p>
<p>Далее, каждый пользователь выбирает случайно число <i>х</i>, удовлетворяющее неравенству <i>0 < х < q</i>, и вычисляет </p>
<p><img src="img/image525.png" height="27" width="135">              (5.6)</p>
<p>Число <i>х</i> будет секретным ключом пользователя, а число <i>у</i> открытым ключом. Предполагается, что открытые ключи всех пользователей указываются в некотором несекретном, но «сертифицированном» справочнике, который должен быть у всех, кто собирается проверять подписи. Отметим, что в настоящее время найти <i>х</i> по <i>у</i> практически невозможно при указанной выше длине модуля <i>р</i>. На этом этап выбора параметров заканчивается, и мы готовы к тому, чтобы формировать и проверять подписи. </p>
<p>Пусть имеется сообщение <img src="img/image410.png" height="17" width="18">, которое необходимо подписать. Генерация подписи выполняется следующим образом: </p>
<p class=punkt>1. Вычисляем значение хеш-функции <i>h</i> = <img src="img/image509.png" height="22" width="46"> для сообщения <i>m</i>, значение хеш-функции должно лежать в пределах <i>0 < h < q</i> (в российском варианте хеш-функция определяется ГОСТом Р34.11-94). </p>
<p class=punkt>2. Формируем случайное число <i>k</i>, <i>0 < k < q</i>. </p>
<p class=punkt>3. Вычисляем <img src="img/image526.png" height="23" width="191">. Если оказывается так, что <i>r = 0</i>, то возвращаемся к шагу 2. </p>
<p class=punkt>4. Вычисляем <img src="img/image528.png" height="21" width="166">. Если <i>s = 0</i>, то возвращаемся к шагу 2.</p>
<p class=punkt>5. Получаем подписанное сообщение <img src="img/image529.png" height="25" width="78">. </p>
<p>Для проверки подписи делаем следующее. </p>
<p class=punkt>1. Вычисляем хеш-функцию для сообщения <i>h</i> = <img src="img/image509.png" height="22" width="46">. </p>
<p class=punkt>2. Проверяем выполнение неравенств <i>0 < r < q</i>, <i>0 < s < q</i>.</p>
<p class=punkt>3. Вычисляем <img src="img/image530.png" height="23" width="149">, <img src="img/image531.png" height="25" width="165">. </p>
<p class=punkt>4. Вычисляем <img src="img/image532.png" height="20" width="207">.</p>
<p class=punkt>5. Проверяем выполнение равенства <img src="img/image533.png" height="15" width="46">. </p>
<p>Если хотя бы одна из проверок на шагах 2 и 5 не дает нужного результата, то подпись считается недействительной. Если же все проверки удачны, то подпись считается подлинной. </p>
<p><b>Утверждение 5.3.</b> <i>Если подпись к сообщению была сформирована законно, т.е. обладателем секретного ключа х, то <img src="img/image533.png" height="15" width="46">.</i> </p>
<p>Д о к а з а т е л ь с т в о. Запишем следующую цепочку равенств, которая следует непосредственно из описания метода (напомним, что показатели степени приводятся по модулю <i>q</i>): </p>
<p><img src="img/image534.png" height="166" width="377"></p>
<p>З а м е ч а н и е. Чтобы найти параметр <i>а</i>, удовлетворяющий (5.5), рекомендуется использовать следующий метод. Берем случайное число <i>g > 1</i> и вычисляем </p>
<p><img src="img/image535.png" height="25" width="157">              (5.7)</p>
<p>Если <i>а > 1</i>, то это то, что нам нужно. Действительно, на основании (5.7) и теоремы Ферма имеем </p>
<p><img src="img/image536.png" height="32" width="380"></p>
<p>т.е. выполняется равенство (5.5). Если при вычислении по (5.7) мы получаем <i>а = 1</i> (крайне маловероятный случай), то нужно просто взять другое число <i>g</i>. </p>
<p>Пример 5.2. Выберем общие несекретные параметры </p>
<p><img src="img/image537.png" height="20" width="232"></p>
<p>возьмем <i>g = 10</i> и вычислим </p>
<p><img src="img/image538.png" height="29" width="190"></p>
<p>Выберем секретный ключ <i>х = 6</i> и вычислим открытый ключ </p>
<p><img src="img/image539.png" height="33" width="187"></p>
<p>Сформируем подпись для сообщения <img src="img/image410.png" height="17" width="18"> = <i>ЬааааЬ</i>. Пусть для хеш-функции этого сообщения <img src="img/image509.png" height="22" width="46"> = 3. Возьмем случайно число <i>k = 8</i>. Вычислим </p>
<p><img src="img/image540.png" height="63" width="382"></p>
<p>Получаем подписанное сообщение </p>
<p><img src="img/image541.png" height="28" width="142"></p>
<p>Теперь выполним проверку подписи. Если сообщение не изменено, то <i>h = 3</i>. Вычислим </p>
<p><img src="img/image542.png" height="143" width="491"></p>
<p>Мы видим, что <img src="img/image533.png" height="15" width="46">, значит подпись верна. </p>
<p>Теперь остановимся на отличиях американского стандарта от российского. Они сводятся к следующему. </p>
<p class=punkt>1. Длина числа <i>q</i> берется равной 160 бит. </p>
<p class=punkt>2. В качестве хеш-функции используется алгоритм SHA-1. </p>
<p class=punkt>3. При генерации подписи на шаге 4 параметр <i>s</i> вычисляется по формуле <img src="img/image543.png" height="22" width="179">. </p>
<p class=punkt>4. При проверке подписи на шаге 3 <i>u<sub>1</sub></i> и <i>u<sub>2</sub></i> вычисляются по формулам <img src="img/image544.png" height="23" width="147">, <img src="img/image545.png" height="24" width="147">. </p>
<p>С учетом этих отличий нетрудно переписать всю схему подписи в «американском» стиле. Доказательство корректности алгоритма проводится совершенно аналогично.</p>
<br>
<a name=3 class="anchor"></a>
<h3>Задачи и упражнения</h3>

<p>Во всех задачах будем предполагать, что <i>h(m) = m</i> для всех значений <i>m</i>. </p>
<p><b>5.1.</b> Построить подпись RSA для сообщения <i>m</i> при следующих параметрах пользователя: </p>
<p><img src="img/image546.png" height="143" width="298"></p>
<p><a href="lec6.htm#5.1" class=punkt>См. ответ.</a></p>
<p><b>5.2.</b> Для указаннных открытых ключей пользователя RSA проверить подлинность подписанных сообщений: </p>
<p><img src="img/image547.png" height="149" width="376"></p>
<p><a href="lec6.htm#5.2" class=punkt>См. ответ.</a></p>
<p><b>5.3.</b> Сообщество пользователей ГОСТа Р34.10-94 имеют общие параметры <i>q = 11</i>, <i>р = 67</i>, <i>а = 25</i>. Вычислить открытый ключ <i>(у)</i> и построить подпись для сообщения <i>m</i> при следующих секретных параметрах:</p>
<p><img src="img/image548.png" height="141" width="264"></p>
<p><a href="lec6.htm#5.3" class=punkt>См. ответ.</a></p>
<p><b>5.4.</b> Для указаннньх открытых ключей <i>(у)</i> пользователей ГОСТа Р34.10-94 с общими параметрами <i>q = 11</i>, <i>р = 67</i>, <i>а = 25</i> проверить подлинность подписанных сообщений: </p>
<p><img src="img/image549.png" height="148" width="361"></p>
<p><a href="lec6.htm#5.4" class=punkt>См. ответ.</a></p>
<p></p>

 






<br>




<br><br>
<!--конец-->
      
				

				</div>
			</div>
			
      </div>
    </div>
  </div>
	
	<!--Меню навигации по Темам -->	
	<div aria-label="..." class = "nav-menu">
	 <ul class="pager background-transition-slow">
		 <li title="Наверх" style = "margin-right:15px;	"><a class = "glyphicon glyphicon-menu-up page-scroll" href="#page-top"></a></li>
		 <li title="К предыдущей лекции"><a class = "glyphicon glyphicon-menu-left page-scroll" href="lec4.htm"></a></li>
		 <li title="В содержание"><a class = "glyphicon glyphicon-list-alt" href="lec_index.htm"></a></li>
		 <li title="К следующей лекции"><a class = "glyphicon glyphicon-menu-right page-scroll" href="lec6.htm"></a></li>
	 </ul>
	</div>
	<!---->
	
	</div>
  <!-- jQuery -->
  <script src="../lib/js/jquery.js"></script>

  <!-- Bootstrap Core JavaScript -->
  <script src="../lib/js/bootstrap.min.js"></script>

  <!-- Scrolling Nav JavaScript -->
  <script src="../lib/js/jquery.easing.min.js"></script>
  <script src="../lib/js/scrolling-nav.js"></script>

</body>

</html>
